This is a sample repository for a python manpage generator described here:

http://notes.secretsauce.net/notes/2018/10/07_generating-manpages-from-python-and-argparse.html

The original text of the blog post appears below





I find the python ecosystem deeply frustrating. On some level, they fixed some
issues in previous languages. But at the same time, they chose to completely
flaunt long-standing conventions, and have rewritten the world in ways that are
different for no good reason. And when you rewrite the world, you always end up
rewriting only the parts you care about, so your new implementation lacks pieces
that other people find very important.

Today's annoyance: manpages. I have some tools written in python that I'm going
to distribute, and since this isn't intended to be user-hostile, I want to ship
manpages. The documentation already exists in the form of docstrings and
=argparse= option decriptions, so I don't want to /write/ the manpages, but they
should be generated for me. I looked around and I can't find anything anywhere.
There're some hoaky hacks people have come up with to do some of this, but I
don't see any sort of "standard" way to do this at /all/. Even when I reduce the
requirements to almost nothing, I still can't find /anything/. Please tell me if
I missed something.

Anyway, I came up with yet another hoaky hack. It works for me. Sample project:

https://github.com/dkogan/python-argparse-generate-manpages-example

This has a python tool called [[https://github.com/dkogan/python-argparse-generate-manpages-example/blob/master/frobnicate][=frobnicate=]], and a [[https://github.com/dkogan/python-argparse-generate-manpages-example/blob/master/make-pod.pl][script]] to generate its manpage
as a =.pod=. The [[https://github.com/dkogan/python-argparse-generate-manpages-example/blob/master/Makefile][=Makefile=]] has rules to make this =.pod= and to convert it into
a manpage. It works by running =frobnicate --help=, and parsing that output.

The =--help= message is set up to be maximally useful by [[https://github.com/dkogan/python-argparse-generate-manpages-example/blob/master/frobnicate#L21][including the main
docstring into the message]]. This is good not just for the manpages, but to make
an informative =--help=. And this has a nice consequence in that the manpage
generator /only/ needs to look at the =--help= output.

It is assumed that the [[https://github.com/dkogan/python-argparse-generate-manpages-example/blob/master/frobnicate#L3][main docstring]] (and thus the =--help= message) is
formatted like a manpage would be, beginning with a synopsis. This isn't usually
done in python, but it should be; they just like being contrarian for no good
reason.

With those assumptions I can parse the =--help= output, and produce a reasonable
manpage. Converted to html, it looks like [[http://notes.secretsauce.net/notes/2018/10/07_generating-manpages-from-python-and-argparse/python-manpage-example.html][this]]. Not the most exciting thing in
the world, but that's the point.

This could all be cleaned up, and made less brittle. That would be great. In the
meantime, it solves my use case. I'm releasing this into the public domain.
Please use it and hack it up. If you fix it and give the changes back, I
wouldn't complain. And if there're better ways to have done this, somebody
please tell me.
